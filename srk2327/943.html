<!DOCTYPE html>
<html lang="ru">
<head>     <meta name="viewport" content="width=device-width, initial-scale=0.8">
    <META charset="utf8">
    <title>943-й адаптер интерфейсный(Сало). Прошивка</title>
    <link rel="stylesheet" type="text/css" href="../style.css">
    <script type="text/javascript" src="../include.js"></script>
    <link rel="shortcut icon" href="../favicon.ico" type="image/x-icon">
    <script>window.addEventListener('scroll', trackScroll)</script>
</head>

<body>

<a class="to_page_top" title="Наверх">&uparrow;</a>

<div class="menu_and_main_div">

<div class="header_div_2">
    <input title="" name="menu_btn" type="button" value="Меню" onclick="show_menu()" class="menu_button"
           id="menu_button">

    <a href="../menu/index.html">Главная</a>
    <a href="2327.html">СРК-АТ2327 </a>
    <a href="">943-й адаптер интерфейсный(Сало)</a>

    <div class="spoiler_menu" id="menu" style="display: none"></div>
</div>

<div class="left_side_menu">
    <div id="menu_left" class="spoiler_menu"></div>
</div>

<script>
    includeMenu("menu_left", REG_MENU, OPEN);
    includeMenu("menu", REG_MENU, CLOSE);
</script>


<div class="main_div">

    <h1>943-й адаптер интерфейсный(Сало). Прошивка</h1>

    <div class="left_align">
        <a href="../imgs/943/943_principal.jpg">Схема принципиальная</a><br>
        <a href="../imgs/943/dorab.jpg">Что дорабатывать в старых платах</a><br>
        <a href="../imgs/943/plata_s_dorabotkoi.jpg">Плата с доработкой</a>
    </div>

    <p>При перепрошивке <span class="attention">ОБЯЗАТЕЛЬНО</span> стирать предыдущую прошивку

        <img src="../imgs/943/adapter%20prosh.jpg" width="700"/>
    <ul>

        <li>Подключить плату программатора: BLS разъем к плате адаптера, mini-USB к компьютеру</li>
        <li>К плате адаптера подключить питание 12V: 1(-) 2(+)</li>
        <li>Открыть STM32 ST-Link</li>

        <!--suppress CheckImageSize -->
        <img src="../imgs/943/943-progr.png" width="600"/>
        <li>Target &longrightarrow; Connect</li>
        <li>Target &longrightarrow; Program & Verify</li>
        <li>Выбрать прошивку <i>943/adapter.hex (13.07.17)</i></li>
        <li><span class="mark_green">После прошивки на плате загорится второй красный светодиод</span></li>
    </ul>

    <h3>Подключение и настройка</h3>

    <!--suppress CheckImageSize -->
    <img src="../imgs/943/5.jpg" width="900"/>
    <ul>
        <li>К 5-х колодке подключается 1123</li>
        <li>бел-кор-жел-зел-экр (<span class="attention">желтый и зеленый подключаются наоборот!</span>)</li>
        <li><span class="attention">Питание+ (коричневый) на 5х колодке НЕ ПОДКДЮЧАЕТСЯ!!</span>
            на 1123 приборе будут сбои на адаптере. Запитывать от преобразователя!
        </li>
        <li>бел-кор-жел-зел-экр-сер-роз</li>
        <li><span class="mark_green">СРК с 943-им подключается к компу с помощью SARK2_PXR</span></li>

        Через Sark PXR нельзя ни посмотреть адрес адаптера, ни установить желаемый.
        Для этих целей необходимо воспользоваться программой CAT32.

        <li>Запустить CAT32_БАРК (/bin/release/Connections_automatic_tester.exe)</li>
        <li>Выбрать порт и следующие настройки:</li>

        <img src="../imgs/943/cat1.png" width="351"/>
        <li>В окне Сценариев установить следующие параметры</li>

        <img src="../imgs/943/cat2.png" width="1079"/>


        <li>Для того, чтобы узнать, какой адрес адаптера, нужно ввести такую команду:</li>
        <div class="yellow_back">256 > [i=0-255] 03 10 01 00 01 < [x] 03 [LB]</div>

        <br>(Иногда необходимо проверить только, например 5 адресов (когда точно известно, что адрес не больше пяти,
        но при этом не хочется ждать перебора всех 256-и адресов), тогда команда будет такой:<br>
        <div class="yellow_back">5 > [i=0-5] 03 10 01 00 01 < [x] 03 [LB]</div>
        )


        <li>В поле сценариев скопипастить команду и нажать кнопку "Одну команду"</li>
        <li>В окне "Результат обмена" появится такой список:</li>

        <img src="../imgs/943/cat4.png" width="1087"/>

        <li>Одна из строк будет белой и с индификатором "ОК", это значит, что на запрос этого адреса адаптер ответил,
            остается посмотреть, какой адрес вызывался (на картинке стрелкой указано, где), на картинке это цифра 02,
            значит у адаптера второй адрес
        </li>

        <li>Для того, чтобы поменять адрес адаптеру, например со второго на первый, ввести такую команду:
        <div class="yellow_back">1 > 02 06 10 01 00 01 < 02 06 10 01 00 01</div></li>
        <li>Вот такой будет ответ:</li>
        <li>(Рисунок)</li>


        <li><a href="../docs/adapter_test_cat32_new3.txt">Здесь</a> можно посмотреть список всех команд для Cat32</li>

        <h3>SARK2 PXR</h3>

        <li>Адаптеры с подключенными дозиметрами 1123 работают и настраиваются в программе SARK2 PXR.
            Чтобы настроить дозиметры, надо:
        </li>
        <ul>
            <li>Если система работает через Ethernet адаптер Moxa-5130, то, прежде всего, его необходимо
                <a href="../docs/NPort_5130-12107098061.pdf">настроить.</a></li>
            <li>В программе SARK2 PXR выбрать "административный режим" (если конфигурация запускается впервые, этот
                режим включится автоматически)</li>
            <img src="../imgs/943/8.PNG" width="800">
            <li>Выбрать COM-порт для подключения</li>
            <li>Выбрать схему (рисунок на задний план)</li>
            <li>В окне администратора нажать поиск. Искать будет долго</li>
            <li>Выбрать поочередно все адаптеры и назначить им пороги</li>
            <li>Нажать "сохранить"</li>

            <li>Перезапустить программу, теперь она запустится в пользовательском режиме. Проверить присутствие всех
                датчиков, наличие счета на каждом из них</li>
            <img src="../imgs/943/7.PNG" width="800">
        </ul>
    </ul>

    <div class="tips_and_tricks">Если нужно установить новые блоки с другими адресами, единственный способ
    &mdash; удалить конфигурационный файл, C:\\ProgramData\ATOMTEX\SARK2_LUE\
        <a href="file://///C:/ProgramData/ATOMTEX/SARK2_LUE/">здесь</a>:
    <img src="../imgs/943/conf.jpg" width="700">
    </div>
</div>
</div>
</body>
</html>