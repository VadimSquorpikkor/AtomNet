<!DOCTYPE html>
<html>
<head>
    <META charset="utf8">
    <title>943-й адаптер интерфейсный(Сало). Прошивка</title>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>

<body>

<div class="header_div">
    <a class="white_font" href="index.html">Содержание </a>
    / 943-й адаптер интерфейсный(Сало)
</div>

<div>

    <h1>943-й адаптер интерфейсный(Сало). Прошивка</h1>

    <p class="right_align">
        <a href="imgs/943/943_principal.jpg">Схема принципиальная</a><br>
        <a href="imgs/943/dorab.jpg">Что дорабатывать в старых платах</a><br>
        <a href="imgs/943/plata_s_dorabotkoi.jpg">Плата с доработкой</a>
    </p>

    При перепрошивке <span class="attention">ОБЯЗАТЕЛЬНО</span> стирать предыдущую прошивку

    <img src="imgs/943/adapter%20prosh.jpg" width="700"/>
    <ul>

        <li>Подключить плату программатора: BLS разъем к плате адаптера, mini-USB к компьютеру</li>
        <li>К плате адаптера подключить питание 12V: 1(-) 2(+)</li>
        <li>Открыть STM32 ST-Link</li>

        <!--suppress CheckImageSize -->
        <img src="imgs/943/943-progr.png" width="600"/>
        <li>Target &longrightarrow; Connect</li>
        <li>Target &longrightarrow; Program & Verify</li>
        <li>Выбрать прошивку <i>943/adapter.hex (13.07.17)</i></li>
        <li><span class="mark_green">После прошивки на плате загорится второй красный светодиод</span></li>
    </ul>

    <h3>Подключение и настройка</h3>

    <!--suppress CheckImageSize -->
    <img src="imgs/943/5.jpg" width="900"/>
    <ul>
        <li>К 5-х колодке подключается 1123</li>
        <li>бел-кор-жел-зел-экр (<span class="attention">желтый и зеленый подключаются наоборот!</span>)</li>
        <li><span class="attention">Питание+ (коричневый) на 5х колодке НЕ ПОДКДЮЧАЕТСЯ!!</span>
            на 1123 приборе будут сбои на адаптере. Запитывать от преобразователя!
        </li>
        <li>бел-кор-жел-зел-экр-сер-роз</li>
        <li><span class="mark_green">СРК с 943-им подключается к компу с помощью SARK2_PXR</span></li>

        Через Sark PXR нельзя ни посмотреть адрес адаптера, ни установить желаемый.
        Для этих целей необходимо воспользоваться программой CAT32.

        <li>Запустить CAT32_БАРК (/bin/release/Connections_automatic_tester.exe)</li>
        <li>Выбрать порт и следующие настройки:</li>

        <img src="imgs/943/cat1.png" width="351"/>
        <li>В окне Сценариев установить следующие параметры</li>

        <img src="imgs/943/cat2.png" width="1079"/>


        <li>Для того, чтобы узнать, какой адрес адаптера, нужно ввести такую команду:</li>
        <span class="yellow_back">256 > [i=0-255] 03 10 01 00 01 < [x] 03 [LB]</span>

        <br>(Иногда необходимо проверить только, например 5 адресов (когда точно известно, что адрес не больше пяти,
        но при этом не хочется ждать перебора всех 256-и адресов), тогда команда будет такой:<br>
        <span class="yellow_back">5 > [i=0-5] 03 10 01 00 01 < [x] 03 [LB]</span><br>)<br>


        <li>В поле сценариев скопипастить команду и нажать кнопку "Одну команду"</li>
        <li>В окне "Результат обмена" появится такой список:</li>

        <img src="imgs/943/cat4.png" width="1087"/>

        <li>Одна из строк будет белой и с индификатором "ОК", это значит, что на запрос этого адреса адаптер ответил,
            остается посмотреть, какой адрес вызывался (на картинке стрелкой указано, где), на картинке это цифра 02,
            значит у адаптера второй адрес
        </li>

        <li>Для того, чтобы поменять адрес адаптеру, например со второго на первый, ввести такую команду:</li>
        <span class="yellow_back">1 > 02 06 10 01 00 01 < 02 06 10 01 00 01</span>
        <li>Вот такой будет ответ:</li>
        <li>(Рисунок)</li>


        <li><a href="docs/adapter_test_cat32_new3.txt">Здесь</a> можно посмотреть список всех команд для Cat32</li>

        <li>После того, как будут заданы все адреса, все адаптеры подключаются через SARK2 PXR</li>
        <li>В окне администратора нажать поиск</li>
        <li>выбрать адаптер назначить ему пороги и нажать сохранить</li>

    </ul>

</div>

</body>
</html>